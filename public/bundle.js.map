{"version":3,"file":"bundle.js","sources":["main.js"],"sourcesContent":["/**\n * Main application file for Flamenco Cante Practice App\n * Connects the UI with the AudioManager\n */\n\nimport AudioManager from '/src/audioManager.js';\n\nclass FlamencoApp {\n  constructor() {\n    this.audioManager = new AudioManager();\n    this.isPlaying = false;\n    this.currentPalo = null;\n    \n    // UI Elements\n    this.paloSelect = document.getElementById('paloSelect');\n    this.playButton = document.getElementById('playButton');\n    this.trackInfo = document.getElementById('trackInfo');\n    this.visualizer = document.getElementById('visualizer');\n    this.statusMessage = document.getElementById('statusMessage');\n    \n    // Control Elements\n    this.tempoSlider = document.getElementById('tempoSlider');\n    this.tempoValue = document.getElementById('tempoValue');\n    this.pitchSlider = document.getElementById('pitchSlider');\n    this.pitchValue = document.getElementById('pitchValue');\n    this.volumeSlider = document.getElementById('volumeSlider');\n    this.volumeValue = document.getElementById('volumeValue');\n    \n    this.init();\n  }\n\n  async init() {\n    try {\n      this.showStatus('Inicializando aplicación...', 'loading');\n      \n      // Set up event listeners\n      this.setupEventListeners();\n      \n      // Load available palos\n      await this.loadAvailablePalos();\n      \n      // Set up audio manager listeners\n      this.setupAudioManagerListeners();\n      \n      this.showStatus('¡Listo para practicar!', 'success');\n      \n    } catch (error) {\n      console.error('Error initializing app:', error);\n      this.showStatus('Error al inicializar la aplicación', 'error');\n    }\n  }\n\n  setupEventListeners() {\n    // Palo selection\n    this.paloSelect.addEventListener('change', (e) => {\n      this.handlePaloChange(e.target.value);\n    });\n\n    // Play/Stop button\n    this.playButton.addEventListener('click', () => {\n      this.handlePlayButtonClick();\n    });\n\n    // Tempo control\n    this.tempoSlider.addEventListener('input', (e) => {\n      const tempo = parseFloat(e.target.value);\n      this.audioManager.setTempo(tempo);\n      this.tempoValue.textContent = `${tempo.toFixed(2)}x`;\n    });\n\n    // Pitch control\n    this.pitchSlider.addEventListener('input', (e) => {\n      const semitones = parseInt(e.target.value);\n      this.audioManager.setPitchSemitones(semitones);\n      this.pitchValue.textContent = semitones > 0 ? `+${semitones}` : `${semitones}`;\n    });\n\n    // Volume control\n    this.volumeSlider.addEventListener('input', (e) => {\n      const volume = parseFloat(e.target.value);\n      this.audioManager.setVolume(volume);\n      this.volumeValue.textContent = `${Math.round(volume * 100)}%`;\n    });\n  }\n\n  setupAudioManagerListeners() {\n    // Listen for track changes\n    this.audioManager.onTrackChange((track) => {\n      this.updateTrackInfo(track);\n    });\n\n    // Listen for play state changes\n    this.audioManager.onPlayStateChange((isPlaying) => {\n      this.updatePlayState(isPlaying);\n    });\n  }\n\n  async loadAvailablePalos() {\n    try {\n      this.showStatus('Cargando palos disponibles...', 'loading');\n      \n      const palos = await this.audioManager.getAvailablePalos();\n      \n      // Clear existing options\n      this.paloSelect.innerHTML = '<option value=\"\">Selecciona un palo</option>';\n      \n      // Add palo options\n      palos.forEach(palo => {\n        const option = document.createElement('option');\n        option.value = palo;\n        option.textContent = palo;\n        this.paloSelect.appendChild(option);\n      });\n      \n      console.log(`Loaded ${palos.length} palos:`, palos);\n      \n    } catch (error) {\n      console.error('Error loading palos:', error);\n      this.showStatus('Error cargando palos disponibles', 'error');\n      this.paloSelect.innerHTML = '<option value=\"\">Error cargando palos</option>';\n    }\n  }\n\n  async handlePaloChange(selectedPalo) {\n    if (!selectedPalo) {\n      this.currentPalo = null;\n      this.playButton.disabled = true;\n      this.updateTrackInfo(null);\n      return;\n    }\n\n    try {\n      this.showStatus(`Cargando pistas de ${selectedPalo}...`, 'loading');\n      this.playButton.disabled = true;\n      \n      // Stop current playback if any\n      if (this.isPlaying) {\n        this.audioManager.stop();\n      }\n      \n      // Load new palo\n      const trackCount = await this.audioManager.loadPalo(selectedPalo);\n      this.currentPalo = selectedPalo;\n      \n      // Enable play button\n      this.playButton.disabled = false;\n      \n      this.showStatus(`${trackCount} pistas cargadas para ${selectedPalo}`, 'success');\n      \n      // Update track info\n      const currentTrack = this.audioManager.getCurrentTrack();\n      this.updateTrackInfo(currentTrack);\n      \n    } catch (error) {\n      console.error('Error loading palo:', error);\n      this.showStatus(`Error cargando ${selectedPalo}`, 'error');\n      this.playButton.disabled = true;\n    }\n  }\n\n  async handlePlayButtonClick() {\n    if (!this.currentPalo) {\n      this.showStatus('Selecciona un palo primero', 'error');\n      return;\n    }\n\n    try {\n      if (this.isPlaying) {\n        // Stop playback\n        this.audioManager.stop();\n        this.showStatus('Reproducción detenida', 'success');\n      } else {\n        // Start playback\n        this.showStatus('Iniciando reproducción...', 'loading');\n        await this.audioManager.play();\n        this.showStatus(`Reproduciendo ${this.currentPalo}`, 'success');\n      }\n    } catch (error) {\n      console.error('Error with playback:', error);\n      this.showStatus('Error en la reproducción', 'error');\n    }\n  }\n\n  updateTrackInfo(track) {\n    const titleElement = this.trackInfo.querySelector('.track-title');\n    const paloElement = this.trackInfo.querySelector('.track-palo');\n    \n    if (track) {\n      titleElement.textContent = track.title;\n      paloElement.textContent = track.palo;\n    } else {\n      titleElement.textContent = this.currentPalo ? \n        'Listo para reproducir' : \n        'Selecciona un palo para comenzar';\n      paloElement.textContent = this.currentPalo || '';\n    }\n  }\n\n  updatePlayState(isPlaying) {\n    this.isPlaying = isPlaying;\n    \n    // Update play button\n    this.playButton.textContent = isPlaying ? '⏸️' : '▶️';\n    \n    // Update visualizer\n    if (isPlaying) {\n      this.visualizer.classList.add('playing');\n    } else {\n      this.visualizer.classList.remove('playing');\n    }\n  }\n\n  showStatus(message, type = '') {\n    this.statusMessage.textContent = message;\n    this.statusMessage.className = `status-message ${type}`;\n    \n    // Auto-clear success messages after 3 seconds\n    if (type === 'success') {\n      setTimeout(() => {\n        if (this.statusMessage.textContent === message) {\n          this.statusMessage.textContent = '';\n          this.statusMessage.className = 'status-message';\n        }\n      }, 3000);\n    }\n  }\n}\n\n// Initialize the app when the page loads\ndocument.addEventListener('DOMContentLoaded', () => {\n  new FlamencoApp();\n});"],"names":["FlamencoApp","constructor","audioManager","AudioManager","isPlaying","currentPalo","paloSelect","document","getElementById","playButton","trackInfo","visualizer","statusMessage","tempoSlider","tempoValue","pitchSlider","pitchValue","volumeSlider","volumeValue","init","showStatus","setupEventListeners","loadAvailablePalos","setupAudioManagerListeners","error","console","addEventListener","e","handlePaloChange","target","value","handlePlayButtonClick","tempo","parseFloat","setTempo","textContent","toFixed","semitones","parseInt","setPitchSemitones","volume","setVolume","Math","round","onTrackChange","track","updateTrackInfo","onPlayStateChange","updatePlayState","palos","getAvailablePalos","innerHTML","forEach","palo","option","createElement","appendChild","log","length","selectedPalo","disabled","stop","trackCount","loadPalo","currentTrack","getCurrentTrack","play","titleElement","querySelector","paloElement","title","classList","add","remove","message","type","className","setTimeout"],"mappings":"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"}